import{r as l,j as e,a as E,V as C,O as b,Y as t}from"./index-2a182a63.js";import{P as v,X as w}from"./websiteSetting-858f1873.js";import{u as F}from"./useExcel-20a1d0aa.js";import{U as L}from"./index-f6e367ea.js";import{C as S}from"./CloudUploadOutlined-141e5939.js";const P=U=>{const{Dragger:i}=L,[c,d]=l.useState([]),[x,m]=l.useState([]),{readDataFromExcel:p}=F();function u(r){const{file:a}=r,s=a.originFileObj;if(!s)return;if(!/\.(xlsx|xls|csv)$/.test(s.name)){t.warning("Excel文件只支持.xlsx, .xls, .csv格式!");return}if(!(s.size/1024/1024<1)){t.warning("上传的Excel文件大小不能超过1M!");return}f(s)}function f(r){const a=new FileReader;a.onload=s=>{const n=s.target&&s.target.result,{header:g,results:h}=p(n,"array"),j=g.map(o=>({title:o,dataIndex:o,align:"center"}));m(j),d(h)},a.readAsArrayBuffer(r),a.onerror=()=>{t.error("Excel文件读取出错!")}}return e.jsx(v,{plugin:w,children:e.jsx(E,{bordered:!1,children:e.jsxs(C,{direction:"vertical",size:16,style:{width:"100%"},children:[e.jsxs(i,{accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:u,children:[e.jsx("p",{className:"ant-upload-drag-icon",style:{marginBottom:0},children:e.jsx(S,{rev:void 0})}),e.jsxs("p",{children:["将Excel文件拖到此处, 或",e.jsx("span",{style:{color:"#1890ff"},children:"点击上传"})]})]}),e.jsx(b,{dataSource:c,columns:x,pagination:!1})]})})})};export{P as default};
