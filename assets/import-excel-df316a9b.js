import{r as l,j as e,a as E,H as C,K as t}from"./index-f5a819a5.js";import{P as b,X as v}from"./websiteSetting-d8e1bb4f.js";import{u as w}from"./useExcel-ca7d6b68.js";import{T as F}from"./Table-02a8b54c.js";import{U as L}from"./index-a9b6d3aa.js";import{C as S}from"./CloudUploadOutlined-eb7c265a.js";import"./addEventListener-b7352c91.js";import"./iconUtil-38bed593.js";import"./objectDestructuringEmpty-24e23e90.js";import"./index-b1f990f7.js";import"./index-52216b8b.js";import"./DeleteOutlined-f637137b.js";const R=U=>{const{Dragger:i}=L,[c,m]=l.useState([]),[d,p]=l.useState([]),{readDataFromExcel:x}=w();function u(a){const{file:s}=a,r=s.originFileObj;if(!r)return;if(!/\.(xlsx|xls|csv)$/.test(r.name)){t.warning("Excel文件只支持.xlsx, .xls, .csv格式!");return}if(!(r.size/1024/1024<1)){t.warning("上传的Excel文件大小不能超过1M!");return}f(r)}function f(a){const s=new FileReader;s.onload=r=>{const o=r.target&&r.target.result,{header:g,results:h}=x(o,"array"),j=g.map(n=>({title:n,dataIndex:n,align:"center"}));p(j),m(h)},s.readAsArrayBuffer(a),s.onerror=()=>{t.error("Excel文件读取出错!")}}return e.jsx(b,{plugin:v,children:e.jsx(E,{bordered:!1,children:e.jsxs(C,{direction:"vertical",size:16,style:{width:"100%"},children:[e.jsxs(i,{accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:u,children:[e.jsx("p",{className:"ant-upload-drag-icon",style:{marginBottom:0},children:e.jsx(S,{rev:void 0})}),e.jsxs("p",{children:["将Excel文件拖到此处, 或",e.jsx("span",{style:{color:"#1890ff"},children:"点击上传"})]})]}),e.jsx(F,{dataSource:c,columns:d,pagination:!1})]})})})};export{R as default};
