import{c as q,j as w,aC as U,i as X,P as Y,H as Z,J as k}from"./antd-b384c7bd.js";import{_ as p,z as b,J as y,A as B,y as I,K as F,L as ee,v as J,w as G,M as ne,N as re,O as K,x as te,P as T,t as ie,Q as ue}from"./entry/index-bcfb3bf6.1706261868846.js";import{r as h,h as ae}from"./react-35d7d5be.js";import{U as oe}from"./index-56f07b71.js";import"./Translatex-2c8245ed.js";var se=function(e){return function(r,n){var t=h.useRef(!1);e(function(){return function(){t.current=!1}},[]),e(function(){if(!t.current)t.current=!0;else return r()},n)}};const W=se(h.useEffect);var Q=function(e,r){var n=r.manual,t=r.ready,u=t===void 0?!0:t,o=r.defaultParams,a=o===void 0?[]:o,c=r.refreshDeps,s=c===void 0?[]:c,i=r.refreshDepsAction,v=h.useRef(!1);return v.current=!1,W(function(){!n&&u&&(v.current=!0,e.run.apply(e,p([],b(a),!1)))},[u]),W(function(){v.current||n||(v.current=!0,i?i():e.refresh())},p([],b(s),!1)),{onBefore:function(){if(!u)return{stopNow:!0}}}};Q.onInit=function(e){var r=e.ready,n=r===void 0?!0:r,t=e.manual;return{loading:!t&&n}};const ce=Q;function fe(e,r){if(e===r)return!0;for(var n=0;n<e.length;n++)if(!Object.is(e[n],r[n]))return!1;return!0}function V(e,r){var n=h.useRef({deps:r,obj:void 0,initialized:!1}).current;return(n.initialized===!1||!fe(n.deps,r))&&(n.deps=r,n.obj=e(),n.initialized=!0),n.obj}var O=new Map,le=function(e,r,n){var t=O.get(e);t!=null&&t.timer&&clearTimeout(t.timer);var u=void 0;r>-1&&(u=setTimeout(function(){O.delete(e)},r)),O.set(e,y(y({},n),{timer:u}))},de=function(e){return O.get(e)},D=new Map,ve=function(e){return D.get(e)},he=function(e,r){D.set(e,r),r.then(function(n){return D.delete(e),n}).catch(function(){D.delete(e)})},C={},me=function(e,r){C[e]&&C[e].forEach(function(n){return n(r)})},$=function(e,r){return C[e]||(C[e]=[]),C[e].push(r),function(){var t=C[e].indexOf(r);C[e].splice(t,1)}},ge=function(e,r){var n=r.cacheKey,t=r.cacheTime,u=t===void 0?5*60*1e3:t,o=r.staleTime,a=o===void 0?0:o,c=r.setCache,s=r.getCache,i=h.useRef(),v=h.useRef(),d=function(f,l){c?c(l):le(f,u,l),me(f,l.data)},m=function(f,l){return l===void 0&&(l=[]),s?s(l):de(f)};return V(function(){if(n){var f=m(n);f&&Object.hasOwnProperty.call(f,"data")&&(e.state.data=f.data,e.state.params=f.params,(a===-1||new Date().getTime()-f.time<=a)&&(e.state.loading=!1)),i.current=$(n,function(l){e.setState({data:l})})}},[]),B(function(){var f;(f=i.current)===null||f===void 0||f.call(i)}),n?{onBefore:function(f){var l=m(n,f);return!l||!Object.hasOwnProperty.call(l,"data")?{}:a===-1||new Date().getTime()-l.time<=a?{loading:!1,data:l==null?void 0:l.data,error:void 0,returnNow:!0}:{data:l==null?void 0:l.data,error:void 0}},onRequest:function(f,l){var g=ve(n);return g&&g!==v.current?{servicePromise:g}:(g=f.apply(void 0,p([],b(l),!1)),v.current=g,he(n,g),{servicePromise:g})},onSuccess:function(f,l){var g;n&&((g=i.current)===null||g===void 0||g.call(i),d(n,{data:f,params:l,time:new Date().getTime()}),i.current=$(n,function(j){e.setState({data:j})}))},onMutate:function(f){var l;n&&((l=i.current)===null||l===void 0||l.call(i),d(n,{data:f,params:e.state.params,time:new Date().getTime()}),i.current=$(n,function(g){e.setState({data:g})}))}}:{}};const pe=ge;var be=function(e,r){var n=r.debounceWait,t=r.debounceLeading,u=r.debounceTrailing,o=r.debounceMaxWait,a=h.useRef(),c=h.useMemo(function(){var s={};return t!==void 0&&(s.leading=t),u!==void 0&&(s.trailing=u),o!==void 0&&(s.maxWait=o),s},[t,u,o]);return h.useEffect(function(){if(n){var s=e.runAsync.bind(e);return a.current=I(function(i){i()},n,c),e.runAsync=function(){for(var i=[],v=0;v<arguments.length;v++)i[v]=arguments[v];return new Promise(function(d,m){var f;(f=a.current)===null||f===void 0||f.call(a,function(){s.apply(void 0,p([],b(i),!1)).then(d).catch(m)})})},function(){var i;(i=a.current)===null||i===void 0||i.cancel(),e.runAsync=s}}},[n,c]),n?{onCancel:function(){var s;(s=a.current)===null||s===void 0||s.cancel()}}:{}};const ye=be;var Pe=function(e,r){var n=r.loadingDelay,t=r.ready,u=h.useRef();if(!n)return{};var o=function(){u.current&&clearTimeout(u.current)};return{onBefore:function(){return o(),t!==!1&&(u.current=setTimeout(function(){e.setState({loading:!0})},n)),{loading:!1}},onFinally:function(){o()},onCancel:function(){o()}}};const Re=Pe;function H(){return F?document.visibilityState!=="hidden":!0}var S=[];function we(e){return S.push(e),function(){var n=S.indexOf(e);S.splice(n,1)}}if(F){var Ce=function(){if(H())for(var e=0;e<S.length;e++){var r=S[e];r()}};window.addEventListener("visibilitychange",Ce,!1)}var Te=function(e,r){var n=r.pollingInterval,t=r.pollingWhenHidden,u=t===void 0?!0:t,o=r.pollingErrorRetryCount,a=o===void 0?-1:o,c=h.useRef(),s=h.useRef(),i=h.useRef(0),v=function(){var d;c.current&&clearTimeout(c.current),(d=s.current)===null||d===void 0||d.call(s)};return W(function(){n||v()},[n]),n?{onBefore:function(){v()},onError:function(){i.current+=1},onSuccess:function(){i.current=0},onFinally:function(){a===-1||a!==-1&&i.current<=a?c.current=setTimeout(function(){!u&&!H()?s.current=we(function(){e.refresh()}):e.refresh()},n):i.current=0},onCancel:function(){v()}}:{}};const xe=Te;function Se(e,r){var n=!1;return function(){for(var t=[],u=0;u<arguments.length;u++)t[u]=arguments[u];n||(n=!0,e.apply(void 0,p([],b(t),!1)),setTimeout(function(){n=!1},r))}}function Ae(){return F&&typeof navigator.onLine!="undefined"?navigator.onLine:!0}var A=[];function je(e){return A.push(e),function(){var n=A.indexOf(e);n>-1&&A.splice(n,1)}}if(F){var z=function(){if(!(!H()||!Ae()))for(var e=0;e<A.length;e++){var r=A[e];r()}};window.addEventListener("visibilitychange",z,!1),window.addEventListener("focus",z,!1)}var Ee=function(e,r){var n=r.refreshOnWindowFocus,t=r.focusTimespan,u=t===void 0?5e3:t,o=h.useRef(),a=function(){var c;(c=o.current)===null||c===void 0||c.call(o)};return h.useEffect(function(){if(n){var c=Se(e.refresh.bind(e),u);o.current=je(function(){c()})}return function(){a()}},[n,u]),B(function(){a()}),{}};const Oe=Ee;var De=function(e,r){var n=r.retryInterval,t=r.retryCount,u=h.useRef(),o=h.useRef(0),a=h.useRef(!1);return t?{onBefore:function(){a.current||(o.current=0),a.current=!1,u.current&&clearTimeout(u.current)},onSuccess:function(){o.current=0},onError:function(){if(o.current+=1,t===-1||o.current<=t){var c=n!=null?n:Math.min(1e3*Math.pow(2,o.current),3e4);u.current=setTimeout(function(){a.current=!0,e.refresh()},c)}else o.current=0},onCancel:function(){o.current=0,u.current&&clearTimeout(u.current)}}:{}};const Fe=De;var Le=function(e,r){var n=r.throttleWait,t=r.throttleLeading,u=r.throttleTrailing,o=h.useRef(),a={};return t!==void 0&&(a.leading=t),u!==void 0&&(a.trailing=u),h.useEffect(function(){if(n){var c=e.runAsync.bind(e);return o.current=ee(function(s){s()},n,a),e.runAsync=function(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];return new Promise(function(v,d){var m;(m=o.current)===null||m===void 0||m.call(o,function(){c.apply(void 0,p([],b(s),!1)).then(v).catch(d)})})},function(){var s;e.runAsync=c,(s=o.current)===null||s===void 0||s.cancel()}}},[n,t,u]),n?{onCancel:function(){var c;(c=o.current)===null||c===void 0||c.cancel()}}:{}};const Me=Le;var $e=function(e){J&&G(e),h.useEffect(function(){e==null||e()},[])};const We=$e;var Be=function(){var e=b(h.useState({}),2),r=e[1];return h.useCallback(function(){return r({})},[])};const He=Be;var Ne=function(){function e(r,n,t,u){u===void 0&&(u={}),this.serviceRef=r,this.options=n,this.subscribe=t,this.initState=u,this.count=0,this.state={loading:!1,params:void 0,data:void 0,error:void 0},this.state=y(y(y({},this.state),{loading:!n.manual}),u)}return e.prototype.setState=function(r){r===void 0&&(r={}),this.state=y(y({},this.state),r),this.subscribe()},e.prototype.runPluginHandler=function(r){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];var u=this.pluginImpls.map(function(o){var a;return(a=o[r])===null||a===void 0?void 0:a.call.apply(a,p([o],b(n),!1))}).filter(Boolean);return Object.assign.apply(Object,p([{}],b(u),!1))},e.prototype.runAsync=function(){for(var r,n,t,u,o,a,c,s,i,v,d=[],m=0;m<arguments.length;m++)d[m]=arguments[m];return ne(this,void 0,void 0,function(){var f,l,g,j,L,N,M,E,P,R,_;return re(this,function(x){switch(x.label){case 0:if(this.count+=1,f=this.count,l=this.runPluginHandler("onBefore",d),g=l.stopNow,j=g===void 0?!1:g,L=l.returnNow,N=L===void 0?!1:L,M=K(l,["stopNow","returnNow"]),j)return[2,new Promise(function(){})];if(this.setState(y({loading:!0,params:d},M)),N)return[2,Promise.resolve(M.data)];(n=(r=this.options).onBefore)===null||n===void 0||n.call(r,d),x.label=1;case 1:return x.trys.push([1,3,,4]),E=this.runPluginHandler("onRequest",this.serviceRef.current,d).servicePromise,E||(E=(_=this.serviceRef).current.apply(_,p([],b(d),!1))),[4,E];case 2:return P=x.sent(),f!==this.count?[2,new Promise(function(){})]:(this.setState({data:P,error:void 0,loading:!1}),(u=(t=this.options).onSuccess)===null||u===void 0||u.call(t,P,d),this.runPluginHandler("onSuccess",P,d),(a=(o=this.options).onFinally)===null||a===void 0||a.call(o,d,P,void 0),f===this.count&&this.runPluginHandler("onFinally",d,P,void 0),[2,P]);case 3:if(R=x.sent(),f!==this.count)return[2,new Promise(function(){})];throw this.setState({error:R,loading:!1}),(s=(c=this.options).onError)===null||s===void 0||s.call(c,R,d),this.runPluginHandler("onError",R,d),(v=(i=this.options).onFinally)===null||v===void 0||v.call(i,d,void 0,R),f===this.count&&this.runPluginHandler("onFinally",d,void 0,R),R;case 4:return[2]}})})},e.prototype.run=function(){for(var r=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];this.runAsync.apply(this,p([],b(n),!1)).catch(function(u){r.options.onError})},e.prototype.cancel=function(){this.count+=1,this.setState({loading:!1}),this.runPluginHandler("onCancel")},e.prototype.refresh=function(){this.run.apply(this,p([],b(this.state.params||[]),!1))},e.prototype.refreshAsync=function(){return this.runAsync.apply(this,p([],b(this.state.params||[]),!1))},e.prototype.mutate=function(r){var n=G(r)?r(this.state.data):r;this.runPluginHandler("onMutate",n),this.setState({data:n})},e}();const _e=Ne;function Ue(e,r,n){r===void 0&&(r={}),n===void 0&&(n=[]);var t=r.manual,u=t===void 0?!1:t,o=K(r,["manual"]);J&&r.defaultParams&&Array.isArray(r.defaultParams);var a=y({manual:u},o),c=te(e),s=He(),i=V(function(){var v=n.map(function(d){var m;return(m=d==null?void 0:d.onInit)===null||m===void 0?void 0:m.call(d,a)}).filter(Boolean);return new _e(c,a,s,Object.assign.apply(Object,p([{}],b(v),!1)))},[]);return i.options=a,i.pluginImpls=n.map(function(v){return v(i,a)}),We(function(){if(!u){var v=i.state.params||r.defaultParams||[];i.run.apply(i,p([],b(v),!1))}}),B(function(){i.cancel()}),{loading:i.state.loading,data:i.state.data,error:i.state.error,params:i.state.params||[],cancel:T(i.cancel.bind(i)),refresh:T(i.refresh.bind(i)),refreshAsync:T(i.refreshAsync.bind(i)),run:T(i.run.bind(i)),runAsync:T(i.runAsync.bind(i)),mutate:T(i.mutate.bind(i))}}function ze(e,r,n){return Ue(e,r,p(p([],b(n||[]),!1),[ye,Re,xe,Oe,Me,ce,pe,Fe],!1))}const Je=q(({token:e})=>({"add-button":{background:e.colorDefault}})),Xe=()=>{const{styles:e,theme:r,cx:n}=Je(),t=ae(),[u,o]=h.useState([]),{data:a,loading:c}=ze(ue);return h.useEffect(()=>{o((a==null?void 0:a.list)||[])},[a]),w.jsxs(U,{gap:16,vertical:!0,children:[w.jsx(U,{justify:"end",children:w.jsx(X,{className:n(e["add-button"]),type:"primary",icon:w.jsx(Y,{}),onClick:()=>t("/user/add-user"),children:ie("新建")})}),w.jsx(Z,{gutter:[16,16],children:u==null?void 0:u.map((s,i)=>w.jsx(k,{span:8,children:w.jsx(oe,{data:s,index:i,loading:c})},s.id))})]})};export{Xe as default};
