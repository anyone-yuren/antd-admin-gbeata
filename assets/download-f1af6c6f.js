import{j as g,B as u,Y as l}from"./index-2a182a63.js";import{U as w}from"./index-f6e367ea.js";const j=({onSuccess:a})=>{const i=e=>{const{file:t}=e,n=t.originFileObj;if(!n)return;if(!/\.(jpg|png|bmp|jpeg|webp)$/.test(n.name)){l.warning("图片只支持.jpg, .png, .bmp, .jpeg, .webp格式!");return}if(!(n.size/1024/1024<5)){l.warning("上传的图片大小不能超过5M!");return}r(n)},r=e=>{const t=new FileReader;t.onload=n=>{const o=n.target&&n.target.result,s=typeof o=="object"?window.URL.createObjectURL(new Blob([o])):o;a(s)},t.readAsDataURL(e),t.onerror=()=>{l.error("图片读取出错!")}};return g.jsx(w,{action:"",accept:".jpg, .jpeg, .gif, .png, .bmp",multiple:!1,showUploadList:!1,onChange:i,children:g.jsx(u,{type:"primary",children:"上传图片"})})};function h(a){const i=a.split(","),e=i[0].match(/:(.*?);/)[1],t=window.atob(i[1]);let n=t.length;const o=new Uint8Array(n);for(;n--;)o[n]=t.charCodeAt(n);return new Blob([o],{type:e})}function f(a,i){return new Promise((r,e)=>{let t=document.createElement("CANVAS");const n=t.getContext("2d"),o=new Image;o.crossOrigin="",o.onload=function(){if(!t||!n)return e();t.width=o.width,t.height=o.height,n.drawImage(o,0,0);const s=t.toDataURL(i||"image/png");t=null,r(s)},o.src=a})}function I(a){return new Promise((i,r)=>{const e=new Image;e.onload=function(){i({width:e.width,height:e.height})},e.onerror=function(){r()},e.src=a})}function R(a,i){return new Promise((r,e)=>{const{width:t,height:n,quality:o,mimeType:s}=i;let c=document.createElement("CANVAS");const m=c.getContext("2d"),d=new Image;d.crossOrigin="",d.onload=function(){if(!c||!m)return e();c.width=t,c.height=n,m.drawImage(d,0,0,t,n);const p=c.toDataURL(s||"image/png",o);c=null,r(p)},d.src=a})}function B(a,i,r,e){f(a).then(t=>{b(t,i,r,e)})}function b(a,i,r,e){const t=h(a);y(t,i,r,e)}function y(a,i,r,e){const t=typeof e!="undefined"?[e,a]:[a],n=new Blob(t,{type:r||"application/octet-stream"}),o=window.URL.createObjectURL(n),s=document.createElement("a");s.style.display="none",s.href=o,s.setAttribute("download",i),typeof s.download=="undefined"&&s.setAttribute("target","_blank"),document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(o)}export{j as U,b as a,R as c,B as d,I as g};
