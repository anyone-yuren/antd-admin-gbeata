import{r as l,j as e,C,g as E,ad as t}from"./index-7383b3e0.js";import{P as b,X as v}from"./websiteSetting-a81058ed.js";import{u as w}from"./useExcel-572c6522.js";import{T as F}from"./Table-5624cc11.js";import{U as L}from"./index-70f9e531.js";import{C as S}from"./CloudUploadOutlined-97efa104.js";import"./addEventListener-89a92722.js";import"./iconUtil-fc8d22ea.js";import"./objectDestructuringEmpty-24e23e90.js";import"./index-541998de.js";import"./index-23acf828.js";import"./DeleteOutlined-d9417017.js";const R=U=>{const{Dragger:i}=L,[c,d]=l.useState([]),[m,p]=l.useState([]),{readDataFromExcel:x}=w();function u(a){const{file:s}=a,r=s.originFileObj;if(!r)return;if(!/\.(xlsx|xls|csv)$/.test(r.name)){t.warning("Excel文件只支持.xlsx, .xls, .csv格式!");return}if(!(r.size/1024/1024<1)){t.warning("上传的Excel文件大小不能超过1M!");return}f(r)}function f(a){const s=new FileReader;s.onload=r=>{const o=r.target&&r.target.result,{header:g,results:h}=x(o,"array"),j=g.map(n=>({title:n,dataIndex:n,align:"center"}));p(j),d(h)},s.readAsArrayBuffer(a),s.onerror=()=>{t.error("Excel文件读取出错!")}}return e.jsx(b,{plugin:v,children:e.jsx(C,{bordered:!1,children:e.jsxs(E,{direction:"vertical",size:16,style:{width:"100%"},children:[e.jsxs(i,{accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:u,children:[e.jsx("p",{className:"ant-upload-drag-icon",style:{marginBottom:0},children:e.jsx(S,{rev:void 0})}),e.jsxs("p",{children:["将Excel文件拖到此处, 或",e.jsx("span",{style:{color:"#1890ff"},children:"点击上传"})]})]}),e.jsx(F,{dataSource:c,columns:m,pagination:!1})]})})})};export{R as default};
